
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Testen von Hypothesen</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lineare Regression" href="S05a_Regression.html" />
    <link rel="prev" title="Wahrscheinlichkeitsverteilungen" href="S03c_Probability_Distributions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/datascience.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Vorwort.html">
   Vorwort
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  01 Einleitung
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_01/Einleitung.html">
   Business Analytics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_01/Warum_Coding.html">
   Warum Programmieren?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter_01/Fallstudie.html">
   Fallstudie: was sie erwartet
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_01/Introduction_Fallstudie.html">
     Wie riskant sind Aktien?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_01/Umsetzung_Fallstudie.html">
     Umsetzung in Python
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  02 Python | Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_02/01_Warum_Python.html">
   Warum Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_02/Intro_JupyterNotebooks.html">
   Einführung in Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_02/Intro_Python.html">
   Einführung in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter_02/Intro_Modules.html">
   Module nutzen
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  99 Sandbox
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="S02a_Descriptive_Statistics.html">
   Deskriptive Statistik
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S03a_Simulation.html">
   Simulationen mit Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S03c_Probability_Distributions.html">
   Wahrscheinlichkeitsverteilungen
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Testen von Hypothesen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S05a_Regression.html">
   Lineare Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S06a_TidyData.html">
   Tidy Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S07a_Classification.html">
   Klassifikation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S08a_Clustering.html">
   Clusteranalyse
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S09a_Cross_validation.html">
   Cross Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S11_DecisionTrees.html">
   Entscheidungsbäume
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="S12_Ensembles.html">
   Ensemble-Methoden
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Anhang
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../literatur.html">
   Literatur
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <div>
    
</div>

</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
                title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/chapter_analytics/S04a_Estimation&HyptothesisTesting.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
        title="Vollbildmodus"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/fredzett/Skript-Business-Analytics/blob/master/chapters/chapter_analytics/S04a_Estimation&HyptothesisTesting.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Starten Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhalt
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Testen von Hypothesen
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-estimate-uncertainty">
     Why estimate uncertainty?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-estimate-uncertainty">
     How to estimate uncertainty?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-uncertainty">
   Estimating uncertainty
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimation-of-uncertainty-using-probability-theory">
     Estimation of uncertainty using probability theory
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sampling-distribution">
       Sampling distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#expected-value-of-bar-x">
         Expected value of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#standard-deviation-of-bar-x">
         Standard deviation of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#form-of-the-sampling-distribution-of-bar-x">
         Form of the sampling distribution of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#why-do-we-care">
         Why do we care?
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interval-estimation">
       Interval estimation
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#population-standard-deviation-sigma-is-known">
         Population standard deviation
         <span class="math notranslate nohighlight">
          \(\sigma\)
         </span>
         is known
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#population-standard-deviation-sigma-is-unknown">
         Population standard deviation
         <span class="math notranslate nohighlight">
          \(\sigma\)
         </span>
         is unknown
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bootstrapping">
     Bootstrapping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1">
       Example 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3">
       Example 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conclusion">
       Conclusion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hypothesis-testing">
     Hypothesis testing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examples-using-python">
       Examples using python
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#caution-with-p-values">
       Caution with p-values
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Testen von Hypothesen</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Inhalt </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Testen von Hypothesen
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-estimate-uncertainty">
     Why estimate uncertainty?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-estimate-uncertainty">
     How to estimate uncertainty?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimating-uncertainty">
   Estimating uncertainty
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimation-of-uncertainty-using-probability-theory">
     Estimation of uncertainty using probability theory
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sampling-distribution">
       Sampling distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#expected-value-of-bar-x">
         Expected value of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#standard-deviation-of-bar-x">
         Standard deviation of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#form-of-the-sampling-distribution-of-bar-x">
         Form of the sampling distribution of
         <span class="math notranslate nohighlight">
          \(\bar{X}\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#why-do-we-care">
         Why do we care?
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interval-estimation">
       Interval estimation
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#population-standard-deviation-sigma-is-known">
         Population standard deviation
         <span class="math notranslate nohighlight">
          \(\sigma\)
         </span>
         is known
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#population-standard-deviation-sigma-is-unknown">
         Population standard deviation
         <span class="math notranslate nohighlight">
          \(\sigma\)
         </span>
         is unknown
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bootstrapping">
     Bootstrapping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1">
       Example 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2">
       Example 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-3">
       Example 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conclusion">
       Conclusion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hypothesis-testing">
     Hypothesis testing
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examples-using-python">
       Examples using python
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#caution-with-p-values">
       Caution with p-values
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="testen-von-hypothesen">
<h1>Testen von Hypothesen<a class="headerlink" href="#testen-von-hypothesen" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">Datasets</span><span class="p">,</span> <span class="n">plot_density</span><span class="p">,</span> <span class="n">plot_hist</span><span class="p">,</span> <span class="n">plot_line</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="why-estimate-uncertainty">
<h2>Why estimate uncertainty?<a class="headerlink" href="#why-estimate-uncertainty" title="Permalink to this headline">¶</a></h2>
<p>In statistics / data analysis we are commonly estimating <strong>parameters</strong> of the population, i.e. we are estimating numerical characteristics such as the mean or the standard deviation, e.g.</p>
<ul class="simple">
<li><p>what percentage of US voters will vote for Joe Biden?</p></li>
<li><p>how satisfied are our customers with our service?</p></li>
<li><p>what is the relation between body weight and exercise time?</p></li>
</ul>
<p>Unfortunately, most of the time it is not feasible and/or to costly to determine these parameters directly from the population which is why we commonly deal with (representative) samples. We then estimate the parameter in question from our sample and treat it as an
<strong>estimator</strong> for the true population mean.</p>
<ul class="simple">
<li><p>a sample mean is then an estimator for the population mean</p></li>
<li><p>a sample standard deviation is then an estimator for the popoulation standard deviation</p></li>
<li><p>a sample proportion is then an estimator for the population proportion</p></li>
</ul>
<p>While it is easy to make such estimate it is crucial to understand the uncertainty and the possible margin of error of this estimate.</p>
<p>There exist numerous examples (e.g. in journalism) where uncertainty around an estimator is not acknowledged and it is common to only state the point estimate (or summary statistic) instead of the plausible range in which the true parameter may lie. A good example is the news about unemployment figures. Many people don’t realize that these numbers commonly are an estimate based on a sample. However, in stead of stating the range the point estimate is always communicated thereby treated as if certain.</p>
<p><strong>In research we cannot be that slopy and need to understand and determine the uncertainty associated with our estimators.</strong></p>
</div>
<div class="section" id="how-to-estimate-uncertainty">
<h2>How to estimate uncertainty?<a class="headerlink" href="#how-to-estimate-uncertainty" title="Permalink to this headline">¶</a></h2>
<p>Once we have calculated a point estimate (e.g. the mean of a sample). How sure can we be that this estimate actually is close to the (true) mean of the population? After all, we don’t have data about the enitre population, which is why we are <strong>estimating</strong> a statistic from a sample, instead of <strong>calculating</strong> a parameter from a population.</p>
<p>Example:<br />
Let’s assume we conduct a randomized controlled trial to test the effectivenss of a new drug. Our trial yields that the average outcome differs between the treamtment and the control groups.</p>
<p>How do we know that this difference is large enough to state that the groups are actually different, i.e. that the drug is actually effective?</p>
<ul class="simple">
<li><p>Could this be due to chance?</p></li>
<li><p>Is the difference large enough that chance cannot explain the difference?</p></li>
<li><p>How large does the difference have to be that chance cannot explain the difference?</p></li>
</ul>
<p>We cannot assume that the point estimator actually matches the true parameter which is why we should calculate a range of values and a probability that the true parameter is within this range.</p>
<p>There are two approaches to achieve this:</p>
<ol class="simple">
<li><p>using classical statistical concepts and probability theory</p></li>
<li><p>using simulation and intuition</p></li>
</ol>
<p>In the following we will cover both approaches. Note that the first approach is usually covered in introductory statistics courses.</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="estimating-uncertainty">
<h1>Estimating uncertainty<a class="headerlink" href="#estimating-uncertainty" title="Permalink to this headline">¶</a></h1>
<div class="section" id="estimation-of-uncertainty-using-probability-theory">
<h2>Estimation of uncertainty using probability theory<a class="headerlink" href="#estimation-of-uncertainty-using-probability-theory" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sampling-distribution">
<h3>Sampling distribution<a class="headerlink" href="#sampling-distribution" title="Permalink to this headline">¶</a></h3>
<p>From undergraduate statistics you may recall that a sampling distribution is the distribituion of a random sample based estimate (e.g. the mean or the standard deviation). It is the distribution of estimates when taking <span class="math notranslate nohighlight">\(n\)</span> different samples.</p>
<p><strong>Example</strong></p>
<p>We will use (fake) population data on online spending for all family households in Little Town. The data contains:</p>
<p>a. amount of online spending</p>
<p>b. indicator if family has children (1 = yes, 0 = no)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">fake_spent_children</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(29809.4372, 0.633, (5000, 2))
</pre></div>
</div>
</div>
</div>
<p>Let’s assume we are not in possession of this large data set of the enitre population and instead we only have a sample of <span class="math notranslate nohighlight">\(n=50\)</span>. We are interested in two estimators:</p>
<p>a. mean (<span class="math notranslate nohighlight">\(\bar{x}\)</span>) online spending</p>
<p>b. proportion (<span class="math notranslate nohighlight">\(p\)</span>) of families that has children</p>
<p>Below both parameters are estimated using a sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">take_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">total_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">rows_smpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total_rows</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">rows_smpl</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smpl_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">smpl</span> <span class="o">=</span> <span class="n">take_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smpl_size</span><span class="p">)</span>
<span class="n">xbar</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">xbar</span><span class="p">,</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32197.22, 0.64)
</pre></div>
</div>
</div>
</div>
<p>Let’s repeat this for <span class="math notranslate nohighlight">\(1.000\)</span> times to create a sampling distribution. The histograms below give an approximation of the sampling distributions of both estimators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sims</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">sims</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sims</span><span class="p">):</span>
    <span class="n">smpl</span> <span class="o">=</span> <span class="n">take_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smpl_size</span><span class="p">)</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="n">estimates</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1606.1079136941726
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">estimates</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(29805.609024, 0.6341220000000001)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_density</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Density of sample mean spending </span><span class="se">\n</span><span class="s2">from $1.000$ random samples of size $50$ each&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Values for $\bar</span><span class="si">{x}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Probability density&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_23_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_density</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Density of sample proportion of children </span><span class="se">\n</span><span class="s2">from $1.000$ random samples of size $50$ each&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Values for $p$&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Probability density&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_24_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_24_0.png" />
</div>
</div>
<p>Obviously, in practice we usually only have one sample (e.g. our sample of <span class="math notranslate nohighlight">\(5.000\)</span> households). However, the above procedure illustrates that</p>
<ul class="simple">
<li><p>in practice many different samples are possible</p></li>
<li><p>each sample therefore generates a different estimator (as proxy for the true parameter)</p></li>
</ul>
<p>Let’s investigate the above sampling distributions in more detail.</p>
<div class="section" id="expected-value-of-bar-x">
<h4>Expected value of <span class="math notranslate nohighlight">\(\bar{X}\)</span><a class="headerlink" href="#expected-value-of-bar-x" title="Permalink to this headline">¶</a></h4>
<p>Th sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span> is the probability distribution of all possible values of the sample mean (in our case online spent). Given we are commonly only in possesssion of one sample we are interested in the mean of all possible values, the <strong>expected value</strong>.</p>
<p>The <strong>expected value of <span class="math notranslate nohighlight">\(\bar{X}\)</span></strong> is given by:</p>
<div class="math notranslate nohighlight">
\[E(\bar{X}) = \mu\]</div>
<p><span class="math notranslate nohighlight">\(\text{where}\)</span><br />
<span class="math notranslate nohighlight">\(E(\bar{X}) = \text{the expected value of \)</span>\bar{X}<span class="math notranslate nohighlight">\(}\)</span><br />
<span class="math notranslate nohighlight">\(\mu = \text{the mean of the population from which the sample is selected}\)</span></p>
<p>You may recall from previous statistical courses that this is called an <strong>unbiased</strong> estimator, as the expected value of a point estimator equals the population parameter.</p>
</div>
<div class="section" id="standard-deviation-of-bar-x">
<h4>Standard deviation of <span class="math notranslate nohighlight">\(\bar{X}\)</span><a class="headerlink" href="#standard-deviation-of-bar-x" title="Permalink to this headline">¶</a></h4>
<p>It can be shown that whenever</p>
<ul class="simple">
<li><p>the population is infinite or</p></li>
<li><p>the population is finite and the sample size is less than or equal to <span class="math notranslate nohighlight">\(5\%\)</span> of the population size (<span class="math notranslate nohighlight">\(\frac{n}{N} \leq 0.05)\)</span></p></li>
</ul>
<p>the standard deviation of <span class="math notranslate nohighlight">\(\bar{X}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}\]</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(\sigma_{\bar{x}} = \text{the standard deviation of \)</span>\bar{X}<span class="math notranslate nohighlight">\(}\)</span><br />
<span class="math notranslate nohighlight">\(\sigma = \text{the standard deviation of the population}\)</span><br />
<span class="math notranslate nohighlight">\(n=\text{the sample size}\)</span></p>
<p>To avoid confusion and to make the distinction between standard deviation of the population / sample and the standard deviation of a point estimate we call the latter <strong>standard error</strong>.</p>
<p>For the remainder of this course we assume that the population size is large and that the above condition holds.</p>
<p>The <strong>standard error</strong> for our example is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1619.9906005459177
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">std_population</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">smpl_size</span><span class="p">)</span>
<span class="n">se</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1619.9906005459177
</pre></div>
</div>
</div>
</div>
<p>Which is fairly close to the standard devision of the sampled means</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1606.1079136941726
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="form-of-the-sampling-distribution-of-bar-x">
<h4>Form of the sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span><a class="headerlink" href="#form-of-the-sampling-distribution-of-bar-x" title="Permalink to this headline">¶</a></h4>
<p>Let’s consider the following two cases:</p>
<ol class="simple">
<li><p>Population data is normally distributed</p></li>
<li><p>Population data is not normally distributed</p></li>
</ol>
<p>In 1. the sampling distribution will also have a normal distribution.</p>
<p>In 2. the <strong>central limit theorem</strong> applies, i.e. with large n the sampling distribution for <span class="math notranslate nohighlight">\(\bar{X}\)</span> also can be approximated with a normal distribution.</p>
<blockquote>
<div><p><strong>Recall: Central limit theorem</strong><br />
when selecting random sample of size <span class="math notranslate nohighlight">\(n\)</span> from a population, the sampling distribution of the sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> is approximated by a normal distribution as the sample size becomes large.</p>
</div></blockquote>
<p>Let’s have a look at a few examples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">100</span> <span class="c1"># size population, size sample</span>
<span class="n">n_smpls</span> <span class="o">=</span> <span class="mi">100_000</span> <span class="c1"># number of samples taken</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="c1">#stats.binom(2,2/6).rvs(N)</span>
<span class="n">plot_density</span><span class="p">(</span><span class="n">pop_dist</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_40_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sample_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="n">n_smpls</span><span class="p">):</span>
    <span class="n">smpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_smpls</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smpl_dist</span> <span class="o">=</span> <span class="n">sample_dist</span><span class="p">(</span><span class="n">pop_dist</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_smpls</span><span class="p">)</span>
<span class="n">plot_density</span><span class="p">(</span><span class="n">smpl_dist</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_42_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_42_0.png" />
</div>
</div>
</div>
<div class="section" id="why-do-we-care">
<h4>Why do we care?<a class="headerlink" href="#why-do-we-care" title="Permalink to this headline">¶</a></h4>
<p>We care about the sample distribution and its properties because it provides useful information about the <strong>difference between the sample mean and the population mean</strong>.</p>
<p><strong>Example:</strong> let us assume that we take the sample mean online-spent as an approximation of the population mean online-spent. However, obviously we are only accepting this approximation if we it likely that the sampled mean is close to the true mean.</p>
<p>If we are willing to accept a deviation of <span class="math notranslate nohighlight">\(1.000\)</span> from the true mean, what is the probability that the sample mean lies within a range of <span class="math notranslate nohighlight">\(1.000\)</span> of the population mean?</p>
<p>We can answer this question using our sampling distributions of <span class="math notranslate nohighlight">\(\bar{X}\)</span> by calculating a z-score (i.e. standard normalizing our sampled values) and then use the CDF of the standard normal distribution to calculate probabilities:</p>
<div class="math notranslate nohighlight">
\[z = \frac{(x \pm \bar{x})}{\sigma_{\bar{x}}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">take_sample</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">50</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">-</span> <span class="mi">1000</span> <span class="c1"># lower bound; standard normal distribution is symetrically</span>
<span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span> <span class="o">/</span> <span class="n">se</span>
<span class="n">zscore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.6172875322011201
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_low</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<span class="n">p_up</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">zscore</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_up</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7314774555036275
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_up</span> <span class="o">-</span> <span class="n">p_low</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.46295491100725505
</pre></div>
</div>
</div>
</div>
<p>We see that the sample mean - given our sample size - has only a probability of <span class="math notranslate nohighlight">\(\approx 50\%\)</span> to be within a range of <span class="math notranslate nohighlight">\(\pm 1.000\)</span> from the population mean.</p>
<p>We can increase this probability by increaing the sample size given the <strong>standard error</strong> is a function of sample size <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Let’s calculate standard error and <span class="math notranslate nohighlight">\(z\)</span> for a sample size of 300 instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smpl_size_new</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">std_population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">std_population</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">smpl_size_new</span><span class="p">)</span>
<span class="n">se</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>661.3583932403976
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span> <span class="o">/</span> <span class="n">se</span>
<span class="n">zscore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.5120394784745845
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_low</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<span class="n">p_up</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">zscore</span><span class="p">)</span>
<span class="n">p_up</span> <span class="o">-</span> <span class="n">p_low</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8694761803235889
</pre></div>
</div>
</div>
</div>
<p>Increasing the sample size to 300 we increasd the probability of the sample mean being within a range of <span class="math notranslate nohighlight">\(\pm 1.000\)</span> of the population mean.</p>
<p><strong>Note:</strong> analysis of <span class="math notranslate nohighlight">\(p\)</span> will be left as an (homework) excercise for you.</p>
</div>
</div>
<div class="section" id="interval-estimation">
<h3>Interval estimation<a class="headerlink" href="#interval-estimation" title="Permalink to this headline">¶</a></h3>
<p>Given point estimators cannot be expected to be an exact value of the true population parameter we usually determine <strong>interval estimates</strong>. We do so by substracting and adding <strong>margin of error</strong> from the point estimator.</p>
<p>Let’s look into more detail how this is done.</p>
<div class="section" id="population-standard-deviation-sigma-is-known">
<h4>Population standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> is known<a class="headerlink" href="#population-standard-deviation-sigma-is-known" title="Permalink to this headline">¶</a></h4>
<p>Although this is usually not the case let’s assume that we can reasonably derive knowledge about the population standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) from historical data.</p>
<p>How can we then construct interval estimates?</p>
<p><strong>Interval estimate of a population mean (when <span class="math notranslate nohighlight">\(\sigma\)</span> is known):</strong></p>
<div class="math notranslate nohighlight">
\[\bar{x} \pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\]</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\((1-\alpha) = \text{the confidence coefficient or level}\)</span>
<span class="math notranslate nohighlight">\(z_{\alpha/2} = \text{the z value providing an area \)</span>\alpha/2<span class="math notranslate nohighlight">\( in the upper tail of the standard normal probability distribution}\)</span></p>
<p><strong>Example</strong>: we take a customer survey with <span class="math notranslate nohighlight">\(80\)</span> customers to determine customer satisfaction.</p>
<p>(Let’s assume that customer satisfaction follows a normal distribution with <span class="math notranslate nohighlight">\(\mu=80\)</span> and <span class="math notranslate nohighlight">\(\sigma = 12\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate population data (for demonstration purposes)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">12</span>
<span class="n">customers</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a sample and calculate the sample mean xbar</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">smpl</span> <span class="o">=</span> <span class="n">customers</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smpl</span><span class="p">)</span><span class="c1">#</span>
<span class="n">xbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79.10215386868747
</pre></div>
</div>
</div>
</div>
<p>From our many previous customer surveys we “know” (i.e. we assume) that the standard deviation of customer satisfaction is 12.</p>
<p>We want to be 95% sure that the interval estimate contains the true population mean (i.e. the true customer satisfaction score). This means that <span class="math notranslate nohighlight">\(\alpha = 5\%\)</span> and we need to determine the <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span>, i.e. the value of the standard normal distribution where only <span class="math notranslate nohighlight">\(2.5\%\)</span> (<span class="math notranslate nohighlight">\(\alpha/2\)</span>) are above.</p>
<p>We are looking for the value <span class="math notranslate nohighlight">\(z\)</span> where <code class="docutils literal notranslate"><span class="pre">stats.norm(0,1).cdf(z)</span></code> <span class="math notranslate nohighlight">\(\approx 2.5\%\)</span>. This could be done using trial and error. However, it is easier to use the <code class="docutils literal notranslate"><span class="pre">stats.norm.ppf</span></code> function which does exactly this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci</span> <span class="o">=</span> <span class="mf">.95</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ci</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.959963984540054
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">se</span> <span class="o">=</span> <span class="n">sig</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">margin</span> <span class="o">=</span>  <span class="n">z</span><span class="o">*</span><span class="n">se</span>
<span class="n">interval</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">+</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">margin</span><span class="p">,</span> <span class="o">-</span><span class="n">margin</span><span class="p">))</span>
<span class="n">interval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([76.47258625, 81.73172149])
</pre></div>
</div>
</div>
</div>
<p>With this interval we are 95% sure that the interval contains the true population mean.</p>
</div>
<div class="section" id="population-standard-deviation-sigma-is-unknown">
<h4>Population standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> is unknown<a class="headerlink" href="#population-standard-deviation-sigma-is-unknown" title="Permalink to this headline">¶</a></h4>
<p>In many real life cases we don’t know what the population standard deviation is. If we knew we mostly wouldn’t need to calculate estimates in the first place. If <span class="math notranslate nohighlight">\(\sigma\)</span> is unknown we must use the <strong>sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>)</strong>.</p>
<p>In this case the margin of error and the interval estimate is based on the probability distribution known as the <strong><span class="math notranslate nohighlight">\(t\)</span> distribution</strong>.</p>
<p>The t distribution is similar to the normal distribution. A specific t distribution depends on one parameter, the <strong>degree of freedom</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># The more degree of freedom the more t-distribution converges to normal distribution</span>
<span class="n">tdist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">tdist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)],</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t-Distribution (df = </span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">vs.</span><span class="se">\n</span><span class="s2"> Standard normal distribution&quot;</span><span class="p">,</span> <span class="n">zero_origin</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;t-Distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;Standard Normal Distribution&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_72_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_72_0.png" />
</div>
</div>
<p>With higher degrees of freedom the t-distribution can be approximated by the normal distribtution. Which can be shown when calculating the t and z values repectively. As a rule of thumb we can assume that with a degree of freedom of <span class="math notranslate nohighlight">\(\geq 100\)</span> the standard normal z value provides a good approximation to the t value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.025</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-1.9623390808264078, -1.9599639845400545)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_dist</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Helper function to show a distribution</span>
    <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">tvalue</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span>
    <span class="n">xlow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">tvalue</span><span class="p">)</span>
    <span class="n">xhigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">tvalue</span><span class="p">,</span><span class="n">high</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xlow</span><span class="p">,</span><span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xlow</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xhigh</span><span class="p">,</span><span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xhigh</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;zero&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">show_dist</span><span class="p">();</span>
<span class="n">show_dist</span><span class="p">(</span><span class="n">dist</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span> <span class="c1"># </span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Standard normal distribution&quot;</span><span class="p">,</span> <span class="s2">&quot;t distribution&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fd588fe9a90&gt;
</pre></div>
</div>
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_76_1.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_76_1.png" />
</div>
</div>
<p>How do we calculate interval estimates?</p>
<p><strong>Interval estimate of a population mean (when <span class="math notranslate nohighlight">\(\sigma\)</span> is unknown):</strong></p>
<div class="math notranslate nohighlight">
\[\bar{x} \pm t_{\alpha/2}\frac{s}{\sqrt{n}}\]</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(s = \text{the sample standard deviation}\)</span><br />
<span class="math notranslate nohighlight">\((1-\alpha) = \text{the confidence coefficient or level}\)</span><br />
<span class="math notranslate nohighlight">\(t_{\alpha/2} = \text{the t value providing an area \)</span>\alpha/2<span class="math notranslate nohighlight">\( in the upper tail of the (student's) t probability distribution}\)</span></p>
<p><strong>Example</strong></p>
<p>We have conducted a study with <span class="math notranslate nohighlight">\(70\)</span> University sutdents to estimate the mean credit card debt for a population of University students. Given we don’t know anything about the population standard deviation we have to work with our sample.</p>
<ul class="simple">
<li><p>we compute mean (<span class="math notranslate nohighlight">\(\bar{x}\)</span>) and standard deviation (<span class="math notranslate nohighlight">\(s\)</span>) of the sample (<span class="math notranslate nohighlight">\(n = 70\)</span>)</p></li>
<li><p>we then compute the margin of error and the interval estimates to determine a range of values that include the true (population) mean with a certainty of <span class="math notranslate nohighlight">\(90\%\)</span></p></li>
</ul>
<p>(Note: the sample data is fake data created using np.random)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smpl</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">credit_card_debt</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smpl</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xbar</span><span class="p">,</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9995.962718784866, 3843.978816977805)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">.1</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">smpl</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.667238548542593
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_margin</span> <span class="o">=</span> <span class="n">t</span><span class="o">*</span><span class="n">s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">xbar</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">error_margin</span><span class="p">,</span> <span class="o">-</span><span class="n">error_margin</span><span class="p">))</span>
<span class="n">ci</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9229.96106217, 10761.9643754 ])
</pre></div>
</div>
</div>
</div>
<p>With a probability of <span class="math notranslate nohighlight">\(90\%\)</span> the true population mean of University student’s credit card debt lies within the above range.</p>
<p>We can see that for a rather small sample size of <span class="math notranslate nohighlight">\(n = 70\)</span> the difference between using the standard normal distribution and the t-distribution makes a difference. The interval estimate using the standard normal distribution is tighter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ci</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate confidence interval for sample using standard normal distribution</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">dist</span> <span class="o">==</span> <span class="s2">&quot;norm&quot;</span><span class="p">:</span> 
        <span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dist</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span><span class="p">:</span> 
        <span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Dist must be either &#39;norm&#39; or &#39;t&#39;&quot;</span><span class="p">)</span>
    
    <span class="n">error_margin</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">error_margin</span><span class="p">,</span> <span class="o">-</span><span class="n">error_margin</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">),</span> <span class="n">ci</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 9240.24566544, 10751.67977213]),
 array([ 9229.96106217, 10761.9643754 ]))
</pre></div>
</div>
</div>
</div>
<p>This difference becomes negigible with a larger data set. Below you can see the difference using a sample size of <span class="math notranslate nohighlight">\(n = 500\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smpl</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">credit_card_debt</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">ci</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">),</span> <span class="n">ci</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 9837.60538399, 10403.73801795]),
 array([ 9837.0788928 , 10404.26450914]))
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bootstrapping">
<h2>Bootstrapping<a class="headerlink" href="#bootstrapping" title="Permalink to this headline">¶</a></h2>
<p>So far we have been using probabilities, theory and assumptions about distributions of populations and samples to calculate estimation intervals.</p>
<p>It turns out there is another (for many people more intuitive way) of calculating the above estimation intervals: <strong>bootstrapping</strong>.</p>
<p><strong>Intuition for bootstrapping algorithm(s):</strong></p>
<p>In theory we could see how much our sample estimator deviates from the true population parameter if we were able to draw many different sample from the population. We could then see how the sample statistic fluctuates.</p>
<p>Bootstraping is build on the assumption that the sample should be a good approximation for the population (otherwise the sampling should be reconsidered because it is e.g. not representative for the population).</p>
<p>Therefore, it is reasonable to create new samples by drawing from our sample.</p>
<p>In doing so we can see how our estimate changes with different samples and draw conclusions from this. It turns out that this simple approach works surpringly well in many contexts.</p>
<p><strong>Algorithm for Nonparametric bootstrap:</strong></p>
<p>Given your sample data <span class="math notranslate nohighlight">\({\{z_i\}_{i=1}^n}\)</span></p>
<p>For <span class="math notranslate nohighlight">\(b = 1 \cdots B\)</span>:</p>
<ul class="simple">
<li><p>resample <em>with replacement</em> <span class="math notranslate nohighlight">\(n\)</span> observations <span class="math notranslate nohighlight">\({\{z_i^{b}\}_{i=1}^n}\)</span></p></li>
<li><p>calculate your estimate <span class="math notranslate nohighlight">\({\hat{\theta}_b}\)</span>, e.g. the mean, using the resampled set of data</p></li>
</ul>
<p>then <span class="math notranslate nohighlight">\({\{\hat{\theta}_b\}_{b=1}^B}\)</span> is  an approximation for the sampling distribution for <span class="math notranslate nohighlight">\(\hat{\theta}\)</span>.</p>
<p>Given the sample distribution we can then calculate the standard error (by calculating the standard deviation of the sample) and hence can calculate the estimate intervals.</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Let’s look at our (fake) credit debt example again.  Let’s say we have a sample of <span class="math notranslate nohighlight">\(n=500\)</span> students and we want to estimate the mean credit debt of (unknown student) population. We want to make sure that our interval estimate with a <span class="math notranslate nohighlight">\(90\%\)</span> probabiltiy contains the population mean.</p>
<p><strong>Traditional approach from previous chapter</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">smpl_original</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">credit_card_debt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">ci</span><span class="p">(</span><span class="n">smpl_original</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span> <span class="p">)</span> <span class="c1"># Note we use standard normal distribution given the large sample size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9837.60538399, 10403.73801795])
</pre></div>
</div>
</div>
</div>
<p><strong>Bootstrapp approach:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bootstrap</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">sims</span><span class="p">):</span> 
    <span class="n">size_smpl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">smpl</span><span class="p">)</span> <span class="c1"># size for samples drawn from original sample</span>

    <span class="n">estimates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">sims</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sims</span><span class="p">):</span>
        <span class="n">new_smpl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">smpl</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size_smpl</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Draw new sample form orginal sample</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">new_smpl</span><span class="p">)</span> <span class="c1"># calculate estimate we want (here: mean)</span>
        <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta</span> <span class="c1"># append to list of estimates (to save distribution)</span>
    
    <span class="k">return</span> <span class="n">estimates</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_sims</span> <span class="o">=</span> <span class="mi">10_000</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">smpl_original</span><span class="p">,</span> <span class="n">n_sims</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_density</span><span class="p">(</span><span class="n">estimates</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sample distribution for mean estimate&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Mean credit debt&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/S04a_Estimation&amp;HyptothesisTesting_101_0.png" src="../../_images/S04a_Estimation&amp;HyptothesisTesting_101_0.png" />
</div>
</div>
<p>We can use this distribution to calculate statistics, e.g. the standard error of our estimate by calculating the standard deviation of estimates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span> <span class="c1"># mean of our estimates (i.e. our point estimate of the true parameter)</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span> <span class="c1"># standard error of our point estimate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">))</span><span class="o">*</span><span class="n">se</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9835.7816785 , 10403.99657339])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">estimates</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 9839.9304876 , 10408.22327707])
</pre></div>
</div>
</div>
</div>
<p>We can see that the bootstrap algorithm is an extremely powerfull tool to estimate uncertainties associated with an estimator.</p>
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p><strong>Determining estimation intervals for proportions</strong></p>
<p>In our very first example we have used online spent data and calculated two estimators:</p>
<ol class="simple">
<li><p>mean of online spent</p></li>
<li><p>proportion of people having children.</p></li>
</ol>
<p>We then looked at 1. to show how to calculate interval estimates; in particular we needed to calculate the standard error for the mean to do this.</p>
<p>In order to calculate the standard error for the proportion, you may recall from undergrad statistics, we need to apply a different formula (because we are looking to calculate the standard deviation from a binomial distributed variable).</p>
<p>the standard deviation of <span class="math notranslate nohighlight">\(p\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\sigma_{p} = \sqrt{\frac{(p(1-p)}{n}}\]</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(p = \text{proportion}\)</span><br />
<span class="math notranslate nohighlight">\(n = \text{the sample size}\)</span></p>
<p>Using the bootsrap approch we can calculate interval estimates for the proportion directly without knowledge about the above formular given we approximate the sample distribution and can thus determine the required statistics directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">fake_spent_children</span><span class="p">()</span>
<span class="n">children</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">1.645</span> <span class="c1"># proxy for stats.norm.ppf(0.95)</span>
<span class="n">p</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="o">-</span><span class="n">se</span><span class="p">,</span><span class="n">se</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_sims</span> <span class="o">=</span> <span class="mi">10_000</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">children</span><span class="p">,</span><span class="n">n_sims</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">estimators</span><span class="p">)</span>
<span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span><span class="mf">1.645</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">se</span><span class="p">,</span><span class="o">-</span><span class="n">se</span><span class="p">))</span>
<span class="n">low</span><span class="p">,</span> <span class="n">high</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_density</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Sample distribution for proportion of households with children ($p$)</span><span class="se">\n</span><span class="s2">(confidence limits determined using bootstrap approach)&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lower limit </span><span class="si">{</span><span class="n">low</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,(</span><span class="n">low</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upper limit </span><span class="si">{</span><span class="n">high</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,(</span><span class="n">high</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h3>
<p><strong>Determine confidence interval for linear regression coefficient</strong></p>
<p>We can use the bootstrap algorithm for model parameters such as regression coefficients as well. This shows the flexibility and power of using bootstrap analysis.</p>
<p>We will use <strong>advertising</strong> data from <a class="reference external" href="http://faculty.marshall.usc.edu/gareth-james/ISL/data.html">ISLR</a> for our next example.</p>
<p>For our example the data contains</p>
<ul class="simple">
<li><p>data on TV advertising spent</p></li>
<li><p>sales data</p></li>
</ul>
<p>We run a simle (linear) regression model of the following type:</p>
<div class="math notranslate nohighlight">
\[\hat{y} \approx \beta_0 + \beta_1x\]</div>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(\hat{y} = \)</span> sales data<br />
<span class="math notranslate nohighlight">\(x = \)</span> tv advertising spent</p>
<p>We want to understand if there is a relation between money spent on tv advertising and generated sales. If not, we should stop or alter tv advertisment. In order to determine the relation we estimate <span class="math notranslate nohighlight">\(\beta_1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">advertising</span><span class="p">()</span> 
<span class="n">tv</span><span class="p">,</span> <span class="n">sales</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can easily calculate coefficients and additional output for regression analysis using the below “helper” function which uses special statistical packages for these purposes (we will introduce them in next lecture).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">lreg_summary</span>

<span class="n">lreg_summary</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span><span class="n">sales</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.612</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.610</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   312.1</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 06 Nov 2020</td> <th>  Prob (F-statistic):</th> <td>1.47e-42</td>
</tr>
<tr>
  <th>Time:</th>                 <td>20:03:36</td>     <th>  Log-Likelihood:    </th> <td> -519.05</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   200</td>      <th>  AIC:               </th> <td>   1042.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   198</td>      <th>  BIC:               </th> <td>   1049.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    7.0326</td> <td>    0.458</td> <td>   15.360</td> <td> 0.000</td> <td>    6.130</td> <td>    7.935</td>
</tr>
<tr>
  <th>x1</th>    <td>    0.0475</td> <td>    0.003</td> <td>   17.668</td> <td> 0.000</td> <td>    0.042</td> <td>    0.053</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 0.531</td> <th>  Durbin-Watson:     </th> <td>   1.935</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.767</td> <th>  Jarque-Bera (JB):  </th> <td>   0.669</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.089</td> <th>  Prob(JB):          </th> <td>   0.716</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.779</td> <th>  Cond. No.          </th> <td>    338.</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>We can see that <span class="math notranslate nohighlight">\(\beta_1\)</span> (denoted <span class="math notranslate nohighlight">\(x_1\)</span>) is <span class="math notranslate nohighlight">\(0.0475\)</span> with a interval estimates of <span class="math notranslate nohighlight">\(0.042\)</span> to <span class="math notranslate nohighlight">\(0.053\)</span>.</p>
<p><strong>Let’s try to recalculate the confidence intervals for <span class="math notranslate nohighlight">\(x1\)</span> using a bootstrap approach.</strong></p>
<p>Our estimator in this case is not the mean or a proportion but <span class="math notranslate nohighlight">\(\beta_1\)</span> which - you may recal from undergraduate statistics - can be calculated as follows:</p>
<div class="math notranslate nohighlight">
\[\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i-\bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}\]</div>
<p>We will have to do the following:</p>
<ol class="simple">
<li><p>implement a function that estimates <span class="math notranslate nohighlight">\(\beta_1\)</span></p></li>
<li><p>bootstrap <span class="math notranslate nohighlight">\(beta_1\)</span> repeatedly to generate a distribution of sampled estimates</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. create function for beta1</span>
<span class="k">def</span> <span class="nf">beta1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. bootstrap</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sims</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">sims</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sims</span><span class="p">):</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">n</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">rows</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">betas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_density</span><span class="p">(</span><span class="n">betas</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate confidence interval from sample distribution</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># alpha is 0.05</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We were able to confirm the confidence intervals (although you may not recall how to actually calculate them) by using a bootstrap approach.</p>
<p>While for our examples most statistical package have “out of the box” functionality, this approach gives us confidence to calculate uncertainty ranges even when using complex models or estimators where no out of the box functionality might be available.</p>
</div>
<div class="section" id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h3>
<p><strong>Advantage</strong></p>
<ul class="simple">
<li><p>does not make strong assumptions about population or sample distributions</p></li>
<li><p>often theoretical sampling distributions are not normally distributed</p></li>
<li><p>is to understand without knowledge in probability theory / about probability distributions</p></li>
<li><p>no knowledge about formulas for standard errors required</p></li>
</ul>
<p><strong>Disadvantage</strong></p>
<ul class="simple">
<li><p>not feasible for large samples because of computational effort</p></li>
<li><p>computational effort when sometimes a simple formular yields an answer</p></li>
</ul>
</div>
</div>
<div class="section" id="hypothesis-testing">
<h2>Hypothesis testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this headline">¶</a></h2>
<p>Please refer to Imai (2017), p. 342 to 362 for background information on hypothesis testing. It is generally assumed that you are familiar with hypothesis testing.</p>
<div class="section" id="examples-using-python">
<h3>Examples using python<a class="headerlink" href="#examples-using-python" title="Permalink to this headline">¶</a></h3>
<p>Below are some examples of how to calculate simple t-tests. We will not cover this in detail as these standard statistics are calculated by statistical packages we will be using when calculating more difficult models.
:
To get an impression how to conduct such tests in python see below</p>
<p><strong>Two-tailed test (one sample)</strong></p>
<p>Example: It is generally assumed that stock returns on average have a daily return of <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Let’s build our hypothesis:</p>
<p>\begin{equation} \label{eq1}
\begin{split}
&amp; H_0: \mu = 0 \
&amp; H_1: \mu \neq 0
\end{split}
\end{equation}</p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(\mu = \)</span> daily stock return</p>
<p>Let’s do this in numpy from scratch. Recall that the test statistic is given by:</p>
<div class="math notranslate nohighlight">
\[z = \frac{\bar{x}-\mu_0}{s/\sqrt{n}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Dax 30 daily data</span>
<span class="n">dax</span> <span class="o">=</span> <span class="n">Datasets</span><span class="o">.</span><span class="n">dax_daily</span><span class="p">()</span> <span class="c1"># prices</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">dax</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="n">dax</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># calculate returns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># our assumed population mean of daily returns</span>
<span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>


<span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">xbar</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">se</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span> <span class="c1"># multiply by two because it is a two-sided t-test</span>
<span class="n">z</span><span class="p">,</span> <span class="n">pvalue</span>
</pre></div>
</div>
</div>
</div>
<p>This can also be done using <code class="docutils literal notranslate"><span class="pre">scipy.stats.ttest_..</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">s</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tvalue</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="c1"># t-statistic and pvalue</span>
<span class="n">tvalue</span><span class="p">,</span> <span class="n">pvalue</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Two-Sample Test</strong></p>
<p>Example: let’s consider a medical trial where we have to groups the trial group (receiving a new medicine) and a control group (receiving a placebo). We now want to understand of the two groups differ regarding a specific parameter.</p>
<p>Let’s build our hypothesis:</p>
<p>\begin{equation} \label{eq1}
\begin{split}
&amp; H_0: \mu_0 = \mu_1 \
&amp; H_1: \mu_0 \neq \mu_1
\end{split}
\end{equation}</p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(\mu = \)</span> is e.g. the mean of a specific medical parameter (e.g. blood sugar).</p>
<p>Let’s implement this in python. Let’s create two groups with random data both <span class="math notranslate nohighlight">\(\sim\)</span> <span class="math notranslate nohighlight">\(N(100,10)\)</span>. A two-sample test should yield that both groups do not differ this is <span class="math notranslate nohighlight">\(H_0\)</span> cannot be rejected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trial_group</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">control_group</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">trial_group</span><span class="p">,</span> <span class="n">control_group</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can see that this is indeed the case given the pvalue of <span class="math notranslate nohighlight">\(69\%\)</span>.</p>
</div>
<div class="section" id="caution-with-p-values">
<h3>Caution with p-values<a class="headerlink" href="#caution-with-p-values" title="Permalink to this headline">¶</a></h3>
<p>In 2016 an article in <em>The American Statistician</em> (<a class="reference external" href="https://amstat.tandfonline.com/doi/full/10.1080/00031305.2016.1154108">here</a>) criticized the</p>
<p>“[…] widespread use of “statistical significance” (generally interpreted as “p 0.05”) as a license for making a claim of a scientific finding (or implied truth) leads to considerable distortion of the scientific process.”</p>
<p>Unfortunately, this practice is still quite common in research. It should be noted that research does not mean “finding effects with a p-value below 5%”. While there is nothing wrong or false about the concept of p-values it is sometimes misused.</p>
<p>This is due to several reasons:</p>
<p>a. p value tends to decrease with largers samples, i.e. the larger the sample the higher the probability of finding a “significant effect” (ceteris paribus)</p>
<p>b. focus is too much on identifying signficiance while confirming the null hypothesis should actually be considered as a finding as well. Instead behaviors termed “p-hacking” becomes common (<a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.590.4360&amp;rep=rep1&amp;type=pdf">see here</a>)</p>
<p>c. focus on one value is misleading; instead at least ranges should be reported; at best additional tests and indication for confirmation of research hypotheses should be provided.</p>
<p>d. statistical significance is often confused with practical relevance</p>
<p><strong>Why p value may be misleading given a large sample size</strong></p>
<p>Strategy of p value hacking is dangerous and may lead to wrong research findings.</p>
<p>In the following we will see that larger samples may lead to statistical effects although the practical relevance of theses statistical significant findings are practically irrelevant.</p>
<p>Let’s consider the following example (from Daniela Witten):</p>
<ul class="simple">
<li><p>we are testing whether a mean of a random varialbe <span class="math notranslate nohighlight">\(X \sim N(0,1)\)</span> is equal to <span class="math notranslate nohighlight">\(0\)</span></p></li>
<li><p>we draw a sample and find that the mean (<span class="math notranslate nohighlight">\(\bar{x}\)</span>) is slightly different from 0 (e.g. 0.000001)</p></li>
<li><p>Practically we can conclude for (almost all) practical research hypothesis that <span class="math notranslate nohighlight">\(H_0\)</span> can be confirmed and that the mean of a sample is <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>However, depending on the size of your sample correctly calculated p-value of your estimator will actually indicate rejection of said hypothesis.</p></li>
</ul>
<p>Let’s look at an example:</p>
<p>Given a large sample size we can use the normal distribution and the z-value to test for significance.</p>
<p>Recall that the test statistic is given by:</p>
<div class="math notranslate nohighlight">
\[z = \frac{\bar{x}-\mu_0}{s/\sqrt{n}}\]</div>
<p>As per our assumption</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s\)</span> will be 1</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_0\)</span> will be zero</p></li>
</ul>
<p>This gives us:</p>
<div class="math notranslate nohighlight">
\[z = \bar{x}*\sqrt{n} = 0.000001 * \sqrt{n}\]</div>
<p>If the sample size is big (e.g. <span class="math notranslate nohighlight">\(10^6\)</span>) - which in the age of big data cannot be considered an exception anymore - the z value will become very big (yielding a low p-value) and leads to the conclusion that <span class="math notranslate nohighlight">\(H_0\)</span> needs to be rejected.</p>
<p>However, for all practical reasons <span class="math notranslate nohighlight">\(\bar{x}\)</span> is very close to zero and we only observe this finding given the large sample size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mf">10e6</span>
<span class="n">xbar</span> <span class="o">=</span> <span class="mf">0.000001</span>
<span class="n">zvalue</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">xbar</span>
<span class="n">zvalue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pvalue</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">zvalue</span><span class="p">)</span>
<span class="n">pvalue</span>
</pre></div>
</div>
</div>
</div>
<p>This does not mean that p-values are wrong. Statistically speaking the result is correct. However, it should be noted that with large sample size we are to see statistical effects that may in fact no indicate practical findings given the deviance from <span class="math notranslate nohighlight">\(H_0\)</span> is negligible.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/chapter_analytics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="S03c_Probability_Distributions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Wahrscheinlichkeitsverteilungen</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="S05a_Regression.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lineare Regression</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>